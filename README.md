# Transcriptomics-Diabetes-Kidney-Disease

# Bioinformatics pipeline that uses transcriptomic data to identify predictive hub genes involved in Diabetic Kidney Disease DKD complications by COVID-19 infection

#Transcriptomic data acquisition 
The microarray expression dataset (GSE30529) was obtained from the NCBI GEO database (https://www.ncbi.nlm.nih.gov/geo/). This dataset is based on the GPL571 platform and comprises human samples from patients with DKD (n = 10) and healthy (non-diabetic) controls (n = 12).

#Differential gene expression analysis
Raw data were processed with the “affy” package available in Bioconductor using the function robust multi-array average (RMA) to convert an “AffyBatch” object into an “ExpressionSet” object (https://www.bioconductor.org/). Then, data normalization was performed. After that, we removed the “batch effect” using  “ComBat” from the sva, and Weighted Gene Co-Expression Network Analysis (WGCNA) to identify outliers. Also, the collapseRows function available in the WGCNA package for collapsing gene expression of several probes in a single measurement per gene, was used. Finally, differential gene expression analysis was performed using the limma package. Log2FC > 1, and FDR < 0.05 values were considered to determine the differentially expressed genes (DEGs). Genes having significant p-values with positive Log2FC represent an increased expression (UP). Those with negative Log2FC values are considered downregulated (DN), while those with p-values above 0.05 do not have changes between stages (NC).

#Functional enrichment analysis for shared pathogenetic DEGs 
The functional enrichment was assessed using the Gene Set Enrichment Analysis (GSEA) of DEGs. Enrichment includes all the Gene Ontology (GO) terms and the Kyoto Encyclopedia of Genes and Genomes (KEGG) and Reactome pathways. The cluster profiler R package (Yu, et al. 2012) was employed for data analysis and visualization. Further, we considered focusing on genes in common pathogenetic processes. Functional enrichment analysis was performed using KEGG and GO terms for biological processes. Finally, the ClueGO (version 2.5.7) module of the Cytoscape software (version 3.9.0) was used to examine the inter-relational pathway analysis of the GO terms and the enriched KEGG and Reactome pathways to identify the most significant genes (doi: 10.1093/bioinformatics/btp101.). First, we identified up and downregulated pathways using the top 200 DEGs. Then, the overlapped genes were considered to perform the same analysis with a kappa score of 0.4, pvalue < 0.05. For statistical tests, hypergeometric two-sided and Benjamini–Hochberg methods were employed (Bindea et al., 2009).

#PPI network and identification of hub genes
The list of 42 DE-human genes previously identified in the common pathogenetic process were analyzed to deep insight into their interactomic roles. Network analysis and visualization were performed using Cytoscape version 3.9.0. STRINGDB platform (https://string-db.org/) was used to obtain physical and functional experimental validated data. For this study, high confidence scores (0.7) and no additional interactors were filtered, keeping only experimental, co-expression and database characterized interactions. Each node in the PPI network represents a protein whereas edges are interactions and connections between them. Finally, the predictive hub genes were obtained using cytoHubba selecting the top five nodes employing the topological algorithm of Maximal Clique Centrality (MCC) (doi: 10.1186/1752-0509-8-S4-S11).  

#Deconvolution of the Gene Regulatory Network (GRN)
The “Corto” algorithm with default parameters is used for the coexpression network inference. This package is freely available on the CRAN repository. The “Corto” algorithm is implemented as a co-expression-based tool that infers GRNs using as an input a TFs list with their targets and an expression matrix data set [DOI: 10.1093/bioinformatics/btaa223]. In brief, Corto uses a combination of Spearman correlation and Data Processing Inequality (DPI), adding bootstrapping to evaluate the significant edges by removing indirect interactions. We used the DKD expression matrix and a human-TF list as input. For this analysis, a p-value= 1 × 10-8 was used as a cut-off, and 100 bootstraps were carried out. Subsequently, an output file containing an inferred enriched GRN was obtained. For network visualization, the Cytoscape environment was used to identify the co-expressed gene modules of each hub gene (doi: 10.1101/gr.1239303.).

#Functional enrichment analysis for co-expressed DEGs in the GRN
The functional enrichment was assessed using the GSEA of each of the five modules of the hub genes co-expressed DEGs. Functional enrichment considered all the GO terms and the KEGG and Reactome pathways. The cluster profiler R package (Yu, et al. 2012) was employed for data analysis. For data visualization the parent terms were depicted in the GRN using biorender environment (https://biorender.com/).

#In silico validation of expression of the predictive hub genes in Coronascape DB
Gene expression data was accessed at the Coronascape repository (Zhou et al., Nature Commun. 2019 10(1):1523.). Coronascape is a resource for the analysis of systems-level datasets. The top statistically overlapped COVID reference lists datasets were analyzed against our gene list (5 hub-DEGs). DEGs conserved among the COVID databases were identified and visualized in Circle Plot (https://genome.cshlp.org/content/early/2009/06/15/gr.092759.109.abstract) using the Circos visualization tool for comparative genomics analysis.

#In silico validation of expression of the predictive hub genes in GTEx database
Gene expression data was accessed at the GTEx repository (https://www.gtexportal.org/). GTEx is a resource for the analysis of tissue-specific level datasets. The five hub genes were tested for multi-gene query expression in kidney, lung, heart, pancreas, and whole blood healthy tissues. Data was visualized in a heatmap plot.


